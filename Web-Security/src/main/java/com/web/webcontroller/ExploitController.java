package com.web.webcontroller;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;
import com.web.webDTO.ExploitRequestDTO;
import com.web.webDTO.ExploitResponseDTO;
import com.web.webservices.ExploitService;

@RestController
@RequestMapping("/api/exploits")
@CrossOrigin(origins = "http://localhost:3000")
public class ExploitController {
	  @Autowired
    private final ExploitService exploitService;

  
    public ExploitController(ExploitService exploitService) {
        this.exploitService = exploitService;
    }

    @PostMapping("/execute")
    public ExploitResponseDTO executeExploit(@RequestBody ExploitRequestDTO request) {
        return exploitService.executeExploit(request);
    }

    @GetMapping("/test-connection")
    public String testConnection() {
        return "Exploit Service is running";
    }

    @ExceptionHandler(Exception.class)
    public ExploitResponseDTO handleException(Exception e) {
        ExploitResponseDTO response = new ExploitResponseDTO();
        response.setSuccess(false);
        response.setResult("Error: " + e.getMessage());
        return response;
    }
}