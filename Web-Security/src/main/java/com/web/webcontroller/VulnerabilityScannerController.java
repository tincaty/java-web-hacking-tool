package com.web.webcontroller;

import java.util.Arrays;
import java.util.List;

//VulnerabilityScannerController.java
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;

import com.web.webDTO.ScanRequestDTO;
import com.web.webDTO.ScanResponseDTO;
import com.web.webservices.VulnerabilityScannerService;

@RestController
@RequestMapping("/api/scanner")
@CrossOrigin(origins="http://localhost:3000")
public class VulnerabilityScannerController {
	 @Autowired
 private final VulnerabilityScannerService scannerService;


 public VulnerabilityScannerController(VulnerabilityScannerService scannerService) {
     this.scannerService = scannerService;
 }

 @PostMapping("/scan")
 public ScanResponseDTO scanEndpoint(@RequestBody ScanRequestDTO request) {
     return scannerService.scanEndpoint(request);
 }
 
 @GetMapping("/attack-types")
 public List<String> getAvailableAttackTypes() {
     return Arrays.asList(
         "Memory Shadowing",
         "Memory Reuse After Free",
         "JSON-Driven Memory Layout Manipulation",
         "TOCTOU via Memory Race",
         "Memory-Based Session Pivoting",
         "JSON-Induced Memory Exhaustion",
         "Memory-Resident Configuration Override",
         "Memory-Based SQL Query Tampering",
         "Memory Cache Poisoning via JSON",
         "Memory-Based Cryptography Bypass",
         "Memory Desync in Distributed Systems",
         "JSON-Driven Memory Pointer Arithmetic Flaws",
         "Memory-Resident Race Conditions in Stateless JWT",
         "Memory Pool Exhaustion via JSON Array Bomb",
         "Type Juggling in Memory-Bound Comparisons",
         "Memory-Based Feature Toggle Abuse",
         "JSON-Induced Memory Fragmentation",
         "Memory Mirroring Across API Versions",
         "Memory-Based Business Rule Injection",
         "Memory-Resident Machine Learning Model Poisoning"
     );
 }
}